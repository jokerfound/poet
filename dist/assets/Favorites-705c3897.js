import{_ as S,u as N,r as V,h as _,m as z,s as B,a as E,o as a,c as i,b as t,t as n,n as y,g as v,F as f,f as b,d as L,w as T,k,p as q}from"./index-2ecfb517.js";import{u as j}from"./poemStore-990be7b1.js";const I={class:"favorites"},R={class:"container"},U={class:"page-header"},G={class:"header-stats"},J={class:"stat-item"},K={class:"stat-number"},O={class:"stat-item"},Q={class:"stat-number"},W={class:"stat-item"},X={class:"stat-number"},Y={class:"favorite-tabs"},Z={key:0,class:"tab-content"},tt={class:"content-header"},st={class:"header-actions"},ot=["disabled"],et={key:0,class:"poems-grid"},nt=["onClick"],at={class:"poem-header"},it={class:"poem-title"},lt={class:"poem-author"},rt={class:"poem-content"},dt={class:"poem-actions"},ct=["onClick"],vt=["onClick"],ut={key:1,class:"empty-state"},mt={key:1,class:"tab-content"},_t={class:"content-header"},pt={class:"header-actions"},ht=["disabled"],yt={key:0,class:"history-list"},ft=["onClick"],bt={class:"history-info"},kt={class:"poem-title"},gt={class:"poem-author"},Ct={class:"read-time"},Ft=["onClick"],$t={key:1,class:"empty-state"},Pt={key:2,class:"tab-content"},wt={key:0,class:"poets-grid"},Dt=["onClick"],Mt={class:"poet-avatar"},xt={class:"avatar-icon"},At={class:"poet-info"},Ht={class:"poet-name"},St={class:"poet-dynasty"},Nt={class:"poet-stats"},Vt={class:"stat"},zt={key:1,class:"empty-state"},Bt={__name:"Favorites",setup(Et){const g=N(),d=j(),c=V("poems"),r=_(()=>d.favoritePoems),u=_(()=>d.readingHistory),F=_(()=>{const e=new Set;return r.value.forEach(s=>{e.add(s.author)}),e}),C=_(()=>{try{return!r.value||!Array.isArray(r.value)?[]:r.value.map(e=>d.poems.find(s=>s&&s.id===e)||{}).filter(e=>e&&e.id)}catch(e){return console.error("è·å–æ”¶è—è¯—è¯æ•°æ®å¤±è´¥:",e),[]}}),p=_(()=>{try{const e=new Map;return!r.value||!Array.isArray(r.value)?[]:(r.value.forEach(s=>{const l=d.poems.find(o=>o&&o.id===s);if(l&&l.author){e.has(l.author)||e.set(l.author,{name:l.author,dynasty:l.dynasty||"æœªçŸ¥æœä»£",avatar:$(l.author),favoriteCount:0});const o=e.get(l.author);o.favoriteCount++}}),Array.from(e.values()))}catch(e){return console.error("è·å–å…³æ³¨è¯—äººæ•°æ®å¤±è´¥:",e),[]}}),$=e=>({æç™½:"ğŸ·",æœç”«:"ğŸ“š",ç™½å±…æ˜“:"âœï¸",ç‹ç»´:"ğŸ¨",è‹è½¼:"ğŸŒŠ",ææ¸…ç…§:"ğŸŒ¸",è¾›å¼ƒç–¾:"âš”ï¸",é™†æ¸¸:"ğŸ’”"})[e]||"ğŸ‘¤",P=e=>e?e.split(`
`).slice(0,2).join(" "):"",w=e=>{const s=new Date,l=new Date(e),o=s-l;return o<6e4?"åˆšåˆš":o<36e5?`${Math.floor(o/6e4)}åˆ†é’Ÿå‰`:o<864e5?`${Math.floor(o/36e5)}å°æ—¶å‰`:o<6048e5?`${Math.floor(o/864e5)}å¤©å‰`:l.toLocaleDateString("zh-CN")},h=e=>{g.push(`/poems/${e}`)},D=e=>{g.push(`/search?q=${e}`)},M=e=>{d.removeFromFavorites(e)},x=e=>{d.removeFromHistory(e)},A=()=>{confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ”¶è—å—ï¼Ÿ")&&d.clearFavorites()},H=()=>{confirm("ç¡®å®šè¦æ¸…ç©ºé˜…è¯»å†å²å—ï¼Ÿ")&&d.clearHistory()};return z(()=>{try{d.loadFromLocalStorage()}catch(e){console.error("åˆå§‹åŒ–æ”¶è—é¡µé¢å¤±è´¥:",e)}}),B(()=>{console.log("Favoritesç»„ä»¶å·²å¸è½½")}),(e,s)=>{const l=E("router-link");return a(),i("div",I,[t("div",R,[t("div",U,[s[6]||(s[6]=t("h1",null,"æˆ‘çš„æ”¶è—",-1)),s[7]||(s[7]=t("p",null,"æ‚¨æ”¶è—çš„è¯—è¯ä½œå“å’Œè¯—äººä¿¡æ¯",-1)),t("div",G,[t("div",J,[t("div",K,n(r.value.length),1),s[3]||(s[3]=t("div",{class:"stat-label"},"æ”¶è—è¯—è¯",-1))]),t("div",O,[t("div",Q,n(u.value.length),1),s[4]||(s[4]=t("div",{class:"stat-label"},"é˜…è¯»è®°å½•",-1))]),t("div",W,[t("div",X,n(F.value.size),1),s[5]||(s[5]=t("div",{class:"stat-label"},"å…³æ³¨è¯—äºº",-1))])])]),t("div",Y,[t("button",{class:y(["tab-btn",{active:c.value==="poems"}]),onClick:s[0]||(s[0]=o=>c.value="poems")},[s[8]||(s[8]=t("span",{class:"tab-icon"},"ğŸ“–",-1)),v(" æ”¶è—è¯—è¯ ("+n(r.value.length)+") ",1)],2),t("button",{class:y(["tab-btn",{active:c.value==="history"}]),onClick:s[1]||(s[1]=o=>c.value="history")},[s[9]||(s[9]=t("span",{class:"tab-icon"},"ğŸ•’",-1)),v(" é˜…è¯»å†å² ("+n(u.value.length)+") ",1)],2),t("button",{class:y(["tab-btn",{active:c.value==="poets"}]),onClick:s[2]||(s[2]=o=>c.value="poets")},[s[10]||(s[10]=t("span",{class:"tab-icon"},"ğŸ‘¥",-1)),v(" å…³æ³¨è¯—äºº ("+n(p.value.length)+") ",1)],2)]),c.value==="poems"?(a(),i("div",Z,[t("div",tt,[s[12]||(s[12]=t("h2",null,"æ”¶è—çš„è¯—è¯",-1)),t("div",st,[t("button",{class:"action-btn",onClick:A,disabled:r.value.length===0},[...s[11]||(s[11]=[t("span",{class:"btn-icon"},"ğŸ—‘ï¸",-1),v(" æ¸…ç©ºæ”¶è— ",-1)])],8,ot)])]),C.value.length>0?(a(),i("div",et,[(a(!0),i(f,null,b(C.value,o=>(a(),i("div",{class:"poem-card",key:o.id,onClick:m=>h(o.id)},[t("div",at,[t("h3",it,n(o.title),1),t("p",lt,n(o.author)+" Â· "+n(o.dynasty),1)]),t("div",rt,n(P(o.content)),1),t("div",dt,[t("button",{class:"action-btn small",onClick:m=>M(o.id)},[...s[13]||(s[13]=[t("span",{class:"btn-icon"},"âŒ",-1),v(" å–æ¶ˆæ”¶è— ",-1)])],8,ct),t("button",{class:"action-btn small secondary",onClick:m=>h(o.id)},[...s[14]||(s[14]=[t("span",{class:"btn-icon"},"ğŸ‘ï¸",-1),v(" æŸ¥çœ‹è¯¦æƒ… ",-1)])],8,vt)])],8,nt))),128))])):(a(),i("div",ut,[s[16]||(s[16]=t("div",{class:"empty-icon"},"ğŸ“š",-1)),s[17]||(s[17]=t("h3",null,"æš‚æ— æ”¶è—è¯—è¯",-1)),s[18]||(s[18]=t("p",null,"å¼€å§‹æ”¶è—æ‚¨å–œæ¬¢çš„è¯—è¯å§ï¼",-1)),L(l,{to:"/poems",class:"btn btn-primary"},{default:T(()=>[...s[15]||(s[15]=[t("span",{class:"btn-icon"},"ğŸ”",-1),v(" å»å‘ç°è¯—è¯ ",-1)])]),_:1})]))])):k("",!0),c.value==="history"?(a(),i("div",mt,[t("div",_t,[s[20]||(s[20]=t("h2",null,"é˜…è¯»å†å²",-1)),t("div",pt,[t("button",{class:"action-btn",onClick:H,disabled:u.value.length===0},[...s[19]||(s[19]=[t("span",{class:"btn-icon"},"ğŸ—‘ï¸",-1),v(" æ¸…ç©ºå†å² ",-1)])],8,ht)])]),u.value.length>0?(a(),i("div",yt,[(a(!0),i(f,null,b(u.value,o=>(a(),i("div",{class:"history-item",key:o.timestamp,onClick:m=>h(o.id)},[t("div",bt,[t("h4",kt,n(o.title),1),t("p",gt,n(o.author),1),t("p",Ct,n(w(o.timestamp)),1)]),t("button",{class:"action-btn small",onClick:q(m=>x(o.timestamp),["stop"])},[...s[21]||(s[21]=[t("span",{class:"btn-icon"},"âŒ",-1)])],8,Ft)],8,ft))),128))])):(a(),i("div",$t,[...s[22]||(s[22]=[t("div",{class:"empty-icon"},"ğŸ•’",-1),t("h3",null,"æš‚æ— é˜…è¯»è®°å½•",-1),t("p",null,"å¼€å§‹é˜…è¯»è¯—è¯æ¥è®°å½•æ‚¨çš„å­¦ä¹ å†ç¨‹ï¼",-1)])]))])):k("",!0),c.value==="poets"?(a(),i("div",Pt,[s[24]||(s[24]=t("div",{class:"content-header"},[t("h2",null,"å…³æ³¨çš„è¯—äºº"),t("p",null,"æ ¹æ®æ‚¨æ”¶è—çš„è¯—è¯è‡ªåŠ¨ç”Ÿæˆ")],-1)),p.value.length>0?(a(),i("div",wt,[(a(!0),i(f,null,b(p.value,o=>(a(),i("div",{class:"poet-card",key:o.id,onClick:m=>D(o.name)},[t("div",Mt,[t("span",xt,n(o.avatar),1)]),t("div",At,[t("h3",Ht,n(o.name),1),t("p",St,n(o.dynasty),1),t("div",Nt,[t("span",Vt,"æ”¶è— "+n(o.favoriteCount)+" é¦–",1)])])],8,Dt))),128))])):(a(),i("div",zt,[...s[23]||(s[23]=[t("div",{class:"empty-icon"},"ğŸ‘¥",-1),t("h3",null,"æš‚æ— å…³æ³¨è¯—äºº",-1),t("p",null,"æ”¶è—è¯—è¯æ¥è‡ªåŠ¨å…³æ³¨è¯—äºº",-1)])]))])):k("",!0)])])}}},qt=S(Bt,[["__scopeId","data-v-f33a5e69"]]);export{qt as default};
