import{_ as S,u as N,r as V,h as _,m as z,s as B,a as E,o as a,c as i,b as t,t as n,n as y,g as v,F as f,f as b,d as L,w as T,k,p as q}from"./index-2ecfb517.js";import{u as j}from"./poemStore-990be7b1.js";const I={class:"favorites"},R={class:"container"},U={class:"page-header"},G={class:"header-stats"},J={class:"stat-item"},K={class:"stat-number"},O={class:"stat-item"},Q={class:"stat-number"},W={class:"stat-item"},X={class:"stat-number"},Y={class:"favorite-tabs"},Z={key:0,class:"tab-content"},tt={class:"content-header"},st={class:"header-actions"},ot=["disabled"],et={key:0,class:"poems-grid"},nt=["onClick"],at={class:"poem-header"},it={class:"poem-title"},lt={class:"poem-author"},rt={class:"poem-content"},dt={class:"poem-actions"},ct=["onClick"],vt=["onClick"],ut={key:1,class:"empty-state"},mt={key:1,class:"tab-content"},_t={class:"content-header"},pt={class:"header-actions"},ht=["disabled"],yt={key:0,class:"history-list"},ft=["onClick"],bt={class:"history-info"},kt={class:"poem-title"},gt={class:"poem-author"},Ct={class:"read-time"},Ft=["onClick"],$t={key:1,class:"empty-state"},Pt={key:2,class:"tab-content"},wt={key:0,class:"poets-grid"},Dt=["onClick"],Mt={class:"poet-avatar"},xt={class:"avatar-icon"},At={class:"poet-info"},Ht={class:"poet-name"},St={class:"poet-dynasty"},Nt={class:"poet-stats"},Vt={class:"stat"},zt={key:1,class:"empty-state"},Bt={__name:"Favorites",setup(Et){const g=N(),d=j(),c=V("poems"),r=_(()=>d.favoritePoems),u=_(()=>d.readingHistory),F=_(()=>{const e=new Set;return r.value.forEach(s=>{e.add(s.author)}),e}),C=_(()=>{try{return!r.value||!Array.isArray(r.value)?[]:r.value.map(e=>d.poems.find(s=>s&&s.id===e)||{}).filter(e=>e&&e.id)}catch(e){return console.error("获取收藏诗词数据失败:",e),[]}}),p=_(()=>{try{const e=new Map;return!r.value||!Array.isArray(r.value)?[]:(r.value.forEach(s=>{const l=d.poems.find(o=>o&&o.id===s);if(l&&l.author){e.has(l.author)||e.set(l.author,{name:l.author,dynasty:l.dynasty||"未知朝代",avatar:$(l.author),favoriteCount:0});const o=e.get(l.author);o.favoriteCount++}}),Array.from(e.values()))}catch(e){return console.error("获取关注诗人数据失败:",e),[]}}),$=e=>({李白:"🍷",杜甫:"📚",白居易:"✍️",王维:"🎨",苏轼:"🌊",李清照:"🌸",辛弃疾:"⚔️",陆游:"💔"})[e]||"👤",P=e=>e?e.split(`
`).slice(0,2).join(" "):"",w=e=>{const s=new Date,l=new Date(e),o=s-l;return o<6e4?"刚刚":o<36e5?`${Math.floor(o/6e4)}分钟前`:o<864e5?`${Math.floor(o/36e5)}小时前`:o<6048e5?`${Math.floor(o/864e5)}天前`:l.toLocaleDateString("zh-CN")},h=e=>{g.push(`/poems/${e}`)},D=e=>{g.push(`/search?q=${e}`)},M=e=>{d.removeFromFavorites(e)},x=e=>{d.removeFromHistory(e)},A=()=>{confirm("确定要清空所有收藏吗？")&&d.clearFavorites()},H=()=>{confirm("确定要清空阅读历史吗？")&&d.clearHistory()};return z(()=>{try{d.loadFromLocalStorage()}catch(e){console.error("初始化收藏页面失败:",e)}}),B(()=>{console.log("Favorites组件已卸载")}),(e,s)=>{const l=E("router-link");return a(),i("div",I,[t("div",R,[t("div",U,[s[6]||(s[6]=t("h1",null,"我的收藏",-1)),s[7]||(s[7]=t("p",null,"您收藏的诗词作品和诗人信息",-1)),t("div",G,[t("div",J,[t("div",K,n(r.value.length),1),s[3]||(s[3]=t("div",{class:"stat-label"},"收藏诗词",-1))]),t("div",O,[t("div",Q,n(u.value.length),1),s[4]||(s[4]=t("div",{class:"stat-label"},"阅读记录",-1))]),t("div",W,[t("div",X,n(F.value.size),1),s[5]||(s[5]=t("div",{class:"stat-label"},"关注诗人",-1))])])]),t("div",Y,[t("button",{class:y(["tab-btn",{active:c.value==="poems"}]),onClick:s[0]||(s[0]=o=>c.value="poems")},[s[8]||(s[8]=t("span",{class:"tab-icon"},"📖",-1)),v(" 收藏诗词 ("+n(r.value.length)+") ",1)],2),t("button",{class:y(["tab-btn",{active:c.value==="history"}]),onClick:s[1]||(s[1]=o=>c.value="history")},[s[9]||(s[9]=t("span",{class:"tab-icon"},"🕒",-1)),v(" 阅读历史 ("+n(u.value.length)+") ",1)],2),t("button",{class:y(["tab-btn",{active:c.value==="poets"}]),onClick:s[2]||(s[2]=o=>c.value="poets")},[s[10]||(s[10]=t("span",{class:"tab-icon"},"👥",-1)),v(" 关注诗人 ("+n(p.value.length)+") ",1)],2)]),c.value==="poems"?(a(),i("div",Z,[t("div",tt,[s[12]||(s[12]=t("h2",null,"收藏的诗词",-1)),t("div",st,[t("button",{class:"action-btn",onClick:A,disabled:r.value.length===0},[...s[11]||(s[11]=[t("span",{class:"btn-icon"},"🗑️",-1),v(" 清空收藏 ",-1)])],8,ot)])]),C.value.length>0?(a(),i("div",et,[(a(!0),i(f,null,b(C.value,o=>(a(),i("div",{class:"poem-card",key:o.id,onClick:m=>h(o.id)},[t("div",at,[t("h3",it,n(o.title),1),t("p",lt,n(o.author)+" · "+n(o.dynasty),1)]),t("div",rt,n(P(o.content)),1),t("div",dt,[t("button",{class:"action-btn small",onClick:m=>M(o.id)},[...s[13]||(s[13]=[t("span",{class:"btn-icon"},"❌",-1),v(" 取消收藏 ",-1)])],8,ct),t("button",{class:"action-btn small secondary",onClick:m=>h(o.id)},[...s[14]||(s[14]=[t("span",{class:"btn-icon"},"👁️",-1),v(" 查看详情 ",-1)])],8,vt)])],8,nt))),128))])):(a(),i("div",ut,[s[16]||(s[16]=t("div",{class:"empty-icon"},"📚",-1)),s[17]||(s[17]=t("h3",null,"暂无收藏诗词",-1)),s[18]||(s[18]=t("p",null,"开始收藏您喜欢的诗词吧！",-1)),L(l,{to:"/poems",class:"btn btn-primary"},{default:T(()=>[...s[15]||(s[15]=[t("span",{class:"btn-icon"},"🔍",-1),v(" 去发现诗词 ",-1)])]),_:1})]))])):k("",!0),c.value==="history"?(a(),i("div",mt,[t("div",_t,[s[20]||(s[20]=t("h2",null,"阅读历史",-1)),t("div",pt,[t("button",{class:"action-btn",onClick:H,disabled:u.value.length===0},[...s[19]||(s[19]=[t("span",{class:"btn-icon"},"🗑️",-1),v(" 清空历史 ",-1)])],8,ht)])]),u.value.length>0?(a(),i("div",yt,[(a(!0),i(f,null,b(u.value,o=>(a(),i("div",{class:"history-item",key:o.timestamp,onClick:m=>h(o.id)},[t("div",bt,[t("h4",kt,n(o.title),1),t("p",gt,n(o.author),1),t("p",Ct,n(w(o.timestamp)),1)]),t("button",{class:"action-btn small",onClick:q(m=>x(o.timestamp),["stop"])},[...s[21]||(s[21]=[t("span",{class:"btn-icon"},"❌",-1)])],8,Ft)],8,ft))),128))])):(a(),i("div",$t,[...s[22]||(s[22]=[t("div",{class:"empty-icon"},"🕒",-1),t("h3",null,"暂无阅读记录",-1),t("p",null,"开始阅读诗词来记录您的学习历程！",-1)])]))])):k("",!0),c.value==="poets"?(a(),i("div",Pt,[s[24]||(s[24]=t("div",{class:"content-header"},[t("h2",null,"关注的诗人"),t("p",null,"根据您收藏的诗词自动生成")],-1)),p.value.length>0?(a(),i("div",wt,[(a(!0),i(f,null,b(p.value,o=>(a(),i("div",{class:"poet-card",key:o.id,onClick:m=>D(o.name)},[t("div",Mt,[t("span",xt,n(o.avatar),1)]),t("div",At,[t("h3",Ht,n(o.name),1),t("p",St,n(o.dynasty),1),t("div",Nt,[t("span",Vt,"收藏 "+n(o.favoriteCount)+" 首",1)])])],8,Dt))),128))])):(a(),i("div",zt,[...s[23]||(s[23]=[t("div",{class:"empty-icon"},"👥",-1),t("h3",null,"暂无关注诗人",-1),t("p",null,"收藏诗词来自动关注诗人",-1)])]))])):k("",!0)])])}}},qt=S(Bt,[["__scopeId","data-v-f33a5e69"]]);export{qt as default};
